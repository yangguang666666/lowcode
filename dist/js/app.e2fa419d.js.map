{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue","webpack:///./src/packages/editor-block.jsx","webpack:///./src/packages/events.js","webpack:///./src/packages/useMenuDragger.js","webpack:///./src/packages/useFocus.js","webpack:///./src/packages/useBlockDragger.js","webpack:///./src/packages/useCommand.js","webpack:///./src/packages/editor.jsx","webpack:///./src/utils/editor-config.jsx","webpack:///./src/App.vue?eabf","webpack:///./src/main.js","webpack:///./src/App.vue?977f"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","class","state","defineComponent","props","block","type","setup","blockStyles","computed","top","left","zIndex","config","inject","blockRef","ref","onMounted","offsetWidth","offsetHeight","alignCenter","width","height","component","componentMap","RenderComponent","render","events","mitt","useMenuDragger","containerRef","currentComponent","dragenter","e","dataTransfer","dropEffect","dragover","preventDefault","dragleave","drop","blocks","offsetY","offsetX","dragstart","addEventListener","emit","dragend","removeEventListener","useFocus","callback","selectIndex","lastSelectBlock","focusData","focus","unfocused","forEach","clearBlockFocus","containerMousedown","blockMousedown","index","stopPropagation","shiftKey","useBlockDragger","dragState","startX","startY","dragging","markLine","reactive","x","y","mousedown","BWidth","BHeight","clientX","clientY","startLeft","startTop","startPos","map","lines","container","ATop","ALeft","AWidth","AHeight","showTop","showLeft","document","mousemove","mouseup","moveX","moveY","Math","abs","durX","durY","idx","useCommand","current","queue","commands","commandArray","destroyArray","registry","command","execute","redo","undo","pushQueue","console","log","keyboard","item","init","this","before","start","deepcopy","end","drag","on","off","after","keyboardEvent","keyCodes","90","89","onKeydown","ctrlKey","keyCode","keyString","join","onUnmounted","fn","modelValue","emits","ctx","set","newValue","containerStyles","buttons","label","icon","handler","componentList","preview","btn","createEditorConfig","register","registerConfig","components","Editor","createApp","App","mount"],"mappings":"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","file":"js/app.e2fa419d.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","<template>\n  <div class=\"app\">\n    <Editor v-model=\"state\" ></Editor>\n  </div>\n</template>\n\n<script>\nimport { ref ,provide} from 'vue';\nimport data from './data.json';\nimport Editor from './packages/editor';\nimport {registerConfig as config} from './utils/editor-config';\nexport default {\n  components:{\n    Editor\n  },\n  setup(){\n    const state = ref(data);\n\n    provide('config',config); // 将组件的配置直接穿日\n\n    return {\n      state\n    }\n  }\n}\n\n</script>\n\n<style lang=\"scss\">\n.app{\n  position:fixed;\n  top:20px;\n  left:20px;\n  right:20px;\n  bottom:20px;\n}\n</style>\n","import { computed, defineComponent, inject, onMounted, ref } from \"vue\";\n\nexport default defineComponent({\n    props: {\n        block: { type: Object }\n    },\n    setup(props) {\n        const blockStyles = computed(() => ({\n            top: `${props.block.top}px`,\n            left: `${props.block.left}px`,\n            zIndex: `${props.block.zIndex}`\n        }));\n        const config = inject('config');\n\n        const blockRef = ref(null)\n        onMounted(() => {\n            let { offsetWidth, offsetHeight } = blockRef.value;\n            if (props.block.alignCenter) { // 说明是拖拽松手的时候才渲染的，其他的默认渲染到页面上的内容不需要居中\n                props.block.left = props.block.left - offsetWidth / 2;\n                props.block.top = props.block.top - offsetHeight / 2; // 原则上重新派发事件\n                props.block.alignCenter = false; // 让渲染后的结果才能去居中\n            }\n            props.block.width = offsetWidth;\n            props.block.height = offsetHeight;\n        })\n\n        return () => {\n            // 通过block的key属性直接获取对应的组件 \n            const component = config.componentMap[props.block.key];\n            // 获取render函数\n            const RenderComponent = component.render();\n            return <div class=\"editor-block\" style={blockStyles.value} ref={blockRef}>\n                {RenderComponent}\n            </div>\n        }\n    }\n})","import mitt from 'mitt';\nexport const events = mitt(); // 导出一个发布订阅的对象 \n","import {events} from './events';\nexport function useMenuDragger(containerRef,data){\n    let currentComponent = null;\n    const dragenter = (e) => {\n        e.dataTransfer.dropEffect = 'move'; // h5拖动的图标\n    }\n    const dragover = (e) => {\n        e.preventDefault();\n    }\n    const dragleave = (e) => {\n        e.dataTransfer.dropEffect = 'none';\n    }\n    const drop = (e) => {\n        // 先留在这\n        let blocks =  data.value.blocks; // 内部已经渲染的组件\n        data.value = {...data.value,blocks:[\n            ...blocks,\n            {\n                top:e.offsetY,\n                left:e.offsetX,\n                zIndex:1,\n                key:currentComponent.key,\n                alignCenter:true // 希望松手的时候你可以居中\n            }\n        ]}\n        currentComponent = null;\n    }\n    const dragstart = (e, component) => {\n        // dragenter进入元素中 添加一个移动的标识\n        // dragover 在目标元素经过 必须要阻止默认行为 否则不能触发drop\n        // dragleave 离开元素的时候 需要增加一个禁用标识\n        // drop 松手的时候 根据拖拽的组件 添加一个组件\n        containerRef.value.addEventListener('dragenter', dragenter)\n        containerRef.value.addEventListener('dragover', dragover)\n        containerRef.value.addEventListener('dragleave', dragleave)\n        containerRef.value.addEventListener('drop', drop)\n        currentComponent = component\n        events.emit('start'); // 发布start\n    }\n    const dragend = (e)=>{\n        containerRef.value.removeEventListener('dragenter', dragenter)\n        containerRef.value.removeEventListener('dragover', dragover)\n        containerRef.value.removeEventListener('dragleave', dragleave)\n        containerRef.value.removeEventListener('drop', drop)\n        events.emit('end'); // 发布end\n    }\n    return {\n        dragstart,\n        dragend\n    }\n}","import {computed, ref} from 'vue'\nexport function useFocus(data,callback){ // 获取哪些元素被选中了\n\n    const selectIndex = ref(-1); // 表示没有任何一个被选中\n\n    // 最后选择的那一个\n    const lastSelectBlock = computed(()=>data.value.blocks[selectIndex.value])\n\n    const focusData = computed(() => {\n        let focus = [];\n        let unfocused = [];\n        data.value.blocks.forEach(block => (block.focus ? focus : unfocused).push(block));\n        return { focus, unfocused }\n    });\n    const clearBlockFocus = () => {\n        data.value.blocks.forEach(block => block.focus = false);\n    }\n    const containerMousedown = () => {\n        clearBlockFocus(); // 点击容器让选中的失去焦点\n        selectIndex.value = -1;\n    }\n    const blockMousedown = (e, block,index) => {\n        e.preventDefault();\n        e.stopPropagation();\n        // block上我们规划一个属性 focus 获取焦点后就将focus变为true\n        if (e.shiftKey) {\n            if(focusData.value.focus.length <=1) {\n                block.focus = true; // 当前只有一个节点被选中时 摁住shift键也不会切换focus状态\n            }else{\n                block.focus = !block.focus;\n            }\n        } else {\n            if (!block.focus) {\n                clearBlockFocus();\n                block.focus = true; // 要清空其他人foucs属性\n            } // 当自己已经被选中了，在次点击时还是选中状态\n        }\n        selectIndex.value = index;\n        callback(e)\n    }\n    return {\n        blockMousedown,\n        containerMousedown,\n        focusData,\n        lastSelectBlock\n    }\n}","import { reactive } from \"vue\";\nimport { events } from \"./events\";\n\nexport function useBlockDragger(focusData, lastSelectBlock, data) {\n    let dragState = {\n        startX: 0,\n        startY: 0,\n        dragging:false // 默认不是正在拖拽\n    }\n    let markLine = reactive({\n        x: null,\n        y: null\n    })\n    const mousedown = (e) => {\n\n        const { width: BWidth, height: BHeight } = lastSelectBlock.value; // 拖拽的最后的元素\n\n        dragState = {\n            startX: e.clientX,\n            startY: e.clientY, // 记录每一个选中的位置\n            startLeft: lastSelectBlock.value.left, // b点拖拽前的位置 left和top\n            startTop: lastSelectBlock.value.top,\n            dragging:false,\n            startPos: focusData.value.focus.map(({ top, left }) => ({ top, left })),\n            lines: (() => {\n                const { unfocused } = focusData.value; // 获取其他没选中的以他们的位置做辅助线\n                let lines = { x: [], y: [] }; // 计算横线的位置用y来存放  x存的是纵向的\n                [...unfocused,\n                    {\n                        top: 0,\n                        left: 0,\n                        width: data.value.container.width,\n                        height: data.value.container.height\n                    }\n                ].forEach((block) => {\n                    const { top: ATop, left: ALeft, width: AWidth, height: AHeight } = block;\n                    // 当此元素拖拽到和A元素top一致的时候，要显示这根辅助线，辅助线的位置就是ATop\n                    lines.y.push({ showTop: ATop, top: ATop });\n                    lines.y.push({ showTop: ATop, top: ATop - BHeight }); // 顶对底\n                    lines.y.push({ showTop: ATop + AHeight / 2, top: ATop + AHeight / 2 - BHeight / 2 }); // 中对中\n                    lines.y.push({ showTop: ATop + AHeight, top: ATop + AHeight }); // 底对顶\n                    lines.y.push({ showTop: ATop + AHeight, top: ATop + AHeight - BHeight }); // 底对底\n\n                    lines.x.push({ showLeft: ALeft, left: ALeft }); // 左对左边\n                    lines.x.push({ showLeft: ALeft + AWidth, left: ALeft + AWidth }); // 右边对左边\n                    lines.x.push({ showLeft: ALeft + AWidth / 2, left: ALeft + AWidth / 2 - BWidth / 2 })\n                    lines.x.push({ showLeft: ALeft + AWidth, left: ALeft + AWidth - BWidth })\n                    lines.x.push({ showLeft: ALeft, left: ALeft - BWidth }) // 左对右\n                });\n                return lines\n            })()\n        }\n        document.addEventListener('mousemove', mousemove);\n        document.addEventListener('mouseup', mouseup)\n    }\n    const mousemove = (e) => {\n        let { clientX: moveX, clientY: moveY } = e;\n        if(!dragState.dragging){\n            dragState.dragging = true;\n            events.emit('start'); // 触发事件就会记住拖拽前的位置\n        }\n\n        // 计算当前元素最新的left和top 去线里面找，找到显示线\n        // 鼠标移动后 - 鼠标移动前 + left就好了\n        let left = moveX - dragState.startX + dragState.startLeft;\n        let top = moveY - dragState.startY + dragState.startTop;\n\n        // 先计算横线  距离参照物元素还有5像素的时候 就显示这根线\n\n        let y = null;\n        let x = null;\n        for (let i = 0; i < dragState.lines.y.length; i++) {\n            const { top: t, showTop: s } = dragState.lines.y[i]; // 获取每一根线\n            if (Math.abs(t - top) < 5) { // 如果小于五说明接近了 \n                y = s; // 线要现实的位置\n                moveY = dragState.startY - dragState.startTop + t; // 容器距离顶部的距离 + 目标的高度 就是最新的moveY\n                // 实现快速和这个元素贴在一起\n                break; // 找到一根线后就跳出循环\n            }\n        }\n        for (let i = 0; i < dragState.lines.x.length; i++) {\n            const { left: l, showLeft: s } = dragState.lines.x[i]; // 获取每一根线\n            if (Math.abs(l - left) < 5) { // 如果小于五说明接近了 \n                x = s; // 线要现实的位置\n                moveX = dragState.startX - dragState.startLeft + l; // 容器距离顶部的距离 + 目标的高度 就是最新的moveY\n                // 实现快速和这个元素贴在一起\n                break; // 找到一根线后就跳出循环\n            }\n        }\n        markLine.x = x; // markline 是一个响应式数据 x，y更新了会导致视图更新\n        markLine.y = y;\n\n\n        let durX = moveX - dragState.startX; // 之前和之后的距离\n        let durY = moveY - dragState.startY;\n        focusData.value.focus.forEach((block, idx) => {\n            block.top = dragState.startPos[idx].top + durY;\n            block.left = dragState.startPos[idx].left + durX;\n        })\n    }\n    const mouseup = (e) => {\n        document.removeEventListener('mousemove', mousemove);\n        document.removeEventListener('mouseup', mouseup)\n        markLine.x = null;\n        markLine.y = null;\n        if(dragState.dragging){ // 如果只是点击就不会触发\n            events.emit('end');\n        }\n    }\n\n    return {\n        mousedown,\n        markLine\n    }\n}","import deepcopy from \"deepcopy\";\nimport { onUnmounted } from \"vue\";\nimport { events } from \"./events\";\n\nexport function useCommand(data) {\n    const state = { // 前进后退需要指针\n        current: -1, // 前进后退的索引值\n        queue: [], //  存放所有的操作命令\n        commands: {}, // 制作命令和执行功能一个映射表  undo : ()=>{}  redo:()=>{}\n        commandArray: [], // 存放所有的命令\n        destroyArray: []\n    }\n    const registry = (command) => {\n        state.commandArray.push(command);\n        state.commands[command.name] = () => { // 命令名字对应执行函数\n            const { redo, undo } = command.execute();\n            redo();\n            if (!command.pushQueue) { // 不需要放到队列中直接跳过即可\n                return\n            }\n            let { queue, current } = state;\n\n            // 如果先放了 组件1 -》 组件2 => 组件3 =》 组件4 - -》 组件3\n            // 组件1 -> 组件3\n            if (queue.length > 0) {\n                queue = queue.slice(0, current + 1); // 可能在放置的过程中有撤销操作，所以根据当前最新的current值来计算新的对了\n                state.queue = queue;\n            }\n            queue.push({ redo, undo }); // 保存指令的前进后退\n            state.current = current + 1;\n            console.log(queue);\n        }\n    }\n    // 注册我们需要的命令\n    registry({\n        name: 'redo',\n        keyboard: 'ctrl+y',\n        execute() {\n            return {\n                redo() {\n                    let item = state.queue[state.current + 1]; // 找到当前的下一步还原操作\n                    if (item) {\n                        item.redo && item.redo();\n                        state.current++;\n                    }\n                }\n            }\n        }\n    })\n    registry({\n        name: 'undo',\n        keyboard: 'ctrl+z',\n        execute() {\n            return {\n                redo() {\n                    if (state.current == -1) return; // 没有可以撤销的了\n                    let item = state.queue[state.current]; // 找到上一步还原\n                    if (item) {\n                        item.undo && item.undo(); // 这里没有操作队列\n                        state.current--;\n                    }\n                }\n            }\n        }\n    });\n    registry({ // 如果希望将操作放到队列中可以增加一个属性 标识等会操作要放到队列中\n        name: 'drag',\n        pushQueue: true,\n        init() { // 初始化操作 默认就会执行\n            this.before = null\n            // 监控拖拽开始事件，保存状态\n            const start = () => {\n                this.before = deepcopy(data.value.blocks)\n            }\n            // 拖拽之后需要触发对应的指令\n            const end = () => {\n                state.commands.drag()\n            }\n            events.on('start', start)\n            events.on('end', end)\n            return () => {\n                events.off('start', start);\n                events.off('end', end)\n            }\n        },\n        execute() { // state.commands.drag()\n            let before = this.before;\n            let after = data.value.blocks // 之后的状态\n            return {\n                redo() { // 默认一松手 就直接把当前事情做了\n                    data.value = { ...data.value, blocks: after }\n                },\n                undo() { // 前一步的\n                    data.value = { ...data.value, blocks: before }\n                }\n            }\n        }\n    });\n    const keyboardEvent = (() => {\n        const keyCodes = {\n            90: 'z',\n            89: 'y'\n        }\n        const onKeydown = (e) => {\n            const { ctrlKey, keyCode } = e; // ctrl+z  / ctrl+y\n            let keyString = [];\n            if (ctrlKey) keyString.push('ctrl');\n            keyString.push(keyCodes[keyCode]);\n            keyString = keyString.join('+');\n\n            state.commandArray.forEach(({ keyboard, name }) => {\n                if (!keyboard) return; // 没有键盘事件\n                if (keyboard === keyString) {\n                    state.commands[name]();\n                    e.preventDefault();\n                }\n            })\n        }\n        const init = () => { // 初始化事件\n            window.addEventListener('keydown', onKeydown)\n            return () => { // 销毁事件\n                window.removeEventListener('keydown', onKeydown)\n            }\n        }\n        return init\n    })();\n    (() => {\n\n        // 监听键盘事件\n        state.destroyArray.push(keyboardEvent())\n        state.commandArray.forEach(command => command.init && state.destroyArray.push(command.init()))\n    })();\n\n    onUnmounted(() => { // 清理绑定的事件\n        state.destroyArray.forEach(fn => fn && fn());\n    })\n    return state;\n}","import { computed, defineComponent, inject, ref } from \"vue\";\nimport './editor.scss'\nimport EditorBlock from './editor-block'\nimport deepcopy from \"deepcopy\";\nimport { useMenuDragger } from \"./useMenuDragger\";\nimport { useFocus } from \"./useFocus\";\nimport { useBlockDragger } from \"./useBlockDragger\";\nimport { useCommand } from \"./useCommand\";\nexport default defineComponent({\n    props: {\n        modelValue: { type: Object }\n    },\n    emits: ['update:modelValue'], // 要触发的时间\n    setup(props, ctx) {\n        const data = computed({\n            get() {\n                return props.modelValue \n            },\n            set(newValue) {\n                ctx.emit('update:modelValue', deepcopy(newValue))\n            }\n        });\n        const containerStyles = computed(() => ({\n            width: data.value.container.width + 'px',\n            height: data.value.container.height + 'px'\n        }))\n\n        const config = inject('config');\n\n        const containerRef = ref(null);\n        // 1.实现菜单的拖拽功能\n        const { dragstart, dragend } = useMenuDragger(containerRef, data);\n\n        // 2.实现获取焦点 选中后可能直接就进行拖拽了\n        let { blockMousedown, focusData, containerMousedown, lastSelectBlock } = useFocus(data, (e) => {\n            // 获取焦点后进行拖拽\n            mousedown(e)\n        });\n        // 2.实现组件拖拽\n        let { mousedown, markLine } = useBlockDragger(focusData, lastSelectBlock,data);\n\n        const {commands} = useCommand(data); // []\n        const buttons = [\n            {label:'撤销', icon :'icon-back',handler:()=>commands.undo()},\n            {label:'重做', icon :'icon-forward',handler:()=>commands.redo()}\n        ];\n\n\n       \n\n\n        return () => <div class=\"editor\">\n            <div class=\"editor-left\">\n                {/* 根据注册列表 渲染对应的内容  可以实现h5的拖拽*/}\n                {config.componentList.map(component => (\n                    <div\n                        class=\"editor-left-item\"\n                        draggable\n                        onDragstart={e => dragstart(e, component)}\n                        onDragend={dragend}\n                    >\n                        <span>{component.label}</span>\n                        <div>{component.preview()}</div>\n                    </div>\n                ))}\n            </div>\n            <div class=\"editor-top\">\n                {buttons.map((btn,index)=>{\n                    return <div class=\"editor-top-button\" onClick={btn.handler}>\n                        <i class={btn.icon}></i>\n                        <span>{btn.label}</span>\n                    </div>\n                })}\n            </div>\n            <div class=\"editor-right\">属性控制栏目</div>\n            <div class=\"editor-container\">\n                {/*  负责产生滚动条 */}\n                <div class=\"editor-container-canvas\">\n                    {/* 产生内容区域 */}\n                    <div\n                        class=\"editor-container-canvas__content\"\n                        style={containerStyles.value}\n                        ref={containerRef}\n                        onMousedown={containerMousedown}\n\n                    >\n                        {\n                            (data.value.blocks.map((block, index) => (\n                                <EditorBlock\n                                    class={block.focus ? 'editor-block-focus' : ''}\n                                    block={block}\n                                    onMousedown={(e) => blockMousedown(e, block, index)}\n                                ></EditorBlock>\n                            )))\n                        }\n\n                        {markLine.x !== null && <div class=\"line-x\" style={{ left: markLine.x + 'px' }}></div>}\n                        {markLine.y !== null && <div class=\"line-y\" style={{ top: markLine.y + 'px' }}></div>}\n\n                    </div>\n\n                </div>\n            </div>\n        </div>\n    }\n})","// 列表区可以显示所有的物料\n// key对应的组件映射关系 \nimport { ElButton, ElInput } from 'element-plus'\n\nfunction createEditorConfig() {\n    const componentList = [];\n    const componentMap = {}\n\n    return {\n        componentList,\n        componentMap,\n        register: (component) => {\n            componentList.push(component);\n            componentMap[component.key] = component;\n        }\n    }\n}\nexport let registerConfig = createEditorConfig();\nregisterConfig.register({\n    label: '文本',\n    preview: () => '预览文本',\n    render: () => '渲染文本',\n    key: 'text'\n})\nregisterConfig.register({\n    label: '按钮',\n    preview: () => <ElButton>预览按钮</ElButton>,\n    render: () => <ElButton>渲染按钮</ElButton>,\n    key: 'button'\n})\nregisterConfig.register({\n    label: '输入框',\n    preview: () => <ElInput placeholder=\"预览输入框\"></ElInput>,\n    render: () => <ElInput placeholder=\"渲染输入框\"></ElInput>,\n    key: 'input'\n});\n\n","import { render } from \"./App.vue?vue&type=template&id=bfc611f8\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=bfc611f8&lang=scss\"\nscript.render = render\n\nexport default script","import { createApp } from 'vue';\nimport App from './App.vue';\n\nimport 'element-plus/lib/theme-chalk/index.css'\n\ncreateApp(App).mount('#app');\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./App.vue?vue&type=style&index=0&id=bfc611f8&lang=scss\""],"sourceRoot":""}